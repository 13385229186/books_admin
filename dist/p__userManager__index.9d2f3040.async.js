"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[258],{38321:function(de,b,e){e.r(b),e.d(b,{default:function(){return ae}});var $=e(15009),h=e.n($),L=e(99289),D=e.n(L),O=e(5574),p=e.n(O),C=e(67294),G=e(90930),N=e(95881),U=e(66309),Z=e(2453),W=e(83622),I=e(41874),f=e(87766),J=e(88360),K=e(20780),H=e(8232),Q=e(17788),X=e(34994),x=e(5966),R=e(64317),Y=e(87547),z=e(94149),k=e(28548),r=e(85893),w=function(v){var T=v.visible,S=v.onCancel,B=v.onSuccess,F=H.Z.useForm(),A=p()(F,1),d=A[0],c=function(g,m){var o=d.getFieldValue("password");return m&&m!==o?Promise.reject(new Error("\u4E24\u6B21\u8F93\u5165\u7684\u5BC6\u7801\u4E0D\u4E00\u81F4!")):Promise.resolve()},E=function(){var s=D()(h()().mark(function g(m){var o;return h()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,(0,I.cn)(m);case 3:o=u.sent,o.status==="success"?(Z.ZP.success("\u7528\u6237\u521B\u5EFA\u6210\u529F"),d.resetFields(),B(),S()):Z.ZP.error(o.msg||"\u7528\u6237\u521B\u5EFA\u5931\u8D25"),u.next=11;break;case 7:u.prev=7,u.t0=u.catch(0),console.error("\u521B\u5EFA\u7528\u6237\u5931\u8D25:",u.t0),Z.ZP.error("\u521B\u5EFA\u7528\u6237\u5931\u8D25");case 11:case"end":return u.stop()}},g,null,[[0,7]])}));return function(m){return s.apply(this,arguments)}}();return(0,r.jsx)(Q.Z,{title:"\u65B0\u5EFA\u7528\u6237",open:T,onCancel:function(){d.resetFields(),S()},footer:null,destroyOnClose:!0,width:500,children:(0,r.jsxs)(X.A,{form:d,onFinish:E,submitter:{searchConfig:{submitText:"\u521B\u5EFA",resetText:"\u91CD\u7F6E"},resetButtonProps:{onClick:function(){return d.resetFields()}}},children:[(0,r.jsx)(x.Z,{name:"username",label:"\u7528\u6237\u540D",fieldProps:{size:"large",prefix:(0,r.jsx)(Y.Z,{})},placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"}]}),(0,r.jsx)(x.Z.Password,{name:"password",label:"\u5BC6\u7801",fieldProps:{size:"large",prefix:(0,r.jsx)(z.Z,{})},placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801!"}]}),(0,r.jsx)(x.Z.Password,{name:"passwordAgain",label:"\u786E\u8BA4\u5BC6\u7801",fieldProps:{size:"large",prefix:(0,r.jsx)(z.Z,{})},placeholder:"\u8BF7\u518D\u6B21\u8F93\u5165\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u786E\u8BA4\u5BC6\u7801!"},{validator:c}]}),(0,r.jsx)(x.Z,{name:"name",label:"\u59D3\u540D",fieldProps:{size:"large"},placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u59D3\u540D"}),(0,r.jsx)(x.Z,{name:"phone",label:"\u624B\u673A\u53F7",fieldProps:{size:"large",prefix:(0,r.jsx)(k.Z,{})},placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",rules:[{pattern:/^1[3-9]\d{9}$/,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\u683C\u5F0F"}]}),(0,r.jsx)(R.Z,{name:"role",label:"\u7528\u6237\u89D2\u8272",width:"md",initialValue:"USER",options:[{label:"\u666E\u901A\u7528\u6237",value:"USER"},{label:"\u7BA1\u7406\u5458",value:"ADMIN"}],rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u7528\u6237\u89D2\u8272"}]}),(0,r.jsx)(R.Z,{name:"status",label:"\u7528\u6237\u72B6\u6001",width:"md",initialValue:f.J0.ACTIVE,options:f.zG.filter(function(s){return s.value!==f.J0.DELETED}).map(function(s){return{label:s.label,value:s.value}}),rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u7528\u6237\u72B6\u6001"}]})]})})},q=w,_=e(58780),ee=e(95663),re=function(){var v=(0,C.useRef)(),T=(0,C.useState)(!1),S=p()(T,2),B=S[0],F=S[1],A=(0,C.useState)(null),d=p()(A,2),c=d[0],E=d[1],s=(0,C.useState)(!1),g=p()(s,2),m=g[0],o=g[1],M=(0,C.useState)(!1),u=p()(M,2),ne=u[0],V=u[1],ue=function(a,n){E({id:a,data:n}),F(!0)},se=function(){var a;(a=v.current)===null||a===void 0||a.reload()},ce={ADMIN:{text:"\u7BA1\u7406\u5458",color:"red"},USER:{text:"\u666E\u901A\u7528\u6237",color:"blue"}},le=[{title:"ID",dataIndex:"id",key:"id",width:60},{title:"\u7528\u6237\u540D",dataIndex:"username",key:"username",ellipsis:!0,render:function(a,n){return(0,r.jsx)("a",{onClick:function(){return ue(n.id,n)},children:n.username})}},{title:"\u59D3\u540D",dataIndex:"name",key:"name",ellipsis:!0,render:function(a){return a||"-"}},{title:"\u624B\u673A\u53F7",dataIndex:"phone",key:"phone",render:function(a){return a||"-"}},{title:"\u89D2\u8272",dataIndex:"role",key:"role",valueType:"select",valueEnum:Object.fromEntries(f.WZ.map(function(t){return[t.value,{text:t.label}]})),render:function(a,n){var l=f.WZ.find(function(j){return j.value===n.role});return l?(0,r.jsx)(U.Z,{color:l.color,children:l.label}):"\u672A\u77E5\u89D2\u8272: ".concat(n.role)}},{title:"\u4FE1\u8A89\u5206",dataIndex:"creditScore",key:"creditScore",render:function(a){return(0,r.jsx)(U.Z,{color:Number(a)>=80?"green":Number(a)>=50?"orange":"red",children:Number(a)})}},{title:"\u72B6\u6001\u64CD\u4F5C",dataIndex:"status",key:"status",valueType:"select",valueEnum:Object.fromEntries(f.zG.map(function(t){return[t.value,{text:t.label}]})),render:function(a,n){return(0,r.jsx)(ee.Z,{status:n.status,configs:f.zG,onChange:function(){var l=D()(h()().mark(function j(i){var P;return h()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,(0,I.az)({userId:n.id,status:i}).then(function(oe){if(oe.status==="fail")throw Error("\u7528\u6237\u72B6\u6001\u4FEE\u6539\u5931\u8D25")});case 2:(P=v.current)===null||P===void 0||P.reload();case 3:case"end":return y.stop()}},j)}));return function(j){return l.apply(this,arguments)}}()})}},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createdAt",key:"createdAt",valueType:"dateTime",hideInTable:!0,hideInSearch:!0},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"updatedAt",key:"updatedAt",valueType:"dateTime",hideInTable:!0,hideInSearch:!0}],ie=function(){var t=D()(h()().mark(function a(n){var l;return h()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n=(0,_.cz)(n),o(!0),i.next=4,(0,I.lE)(n);case 4:if(l=i.sent,l.status!=="fail"){i.next=9;break}return o(!1),Z.ZP.error(l.msg),i.abrupt("return",{data:[],success:!1,total:0});case 9:return o(!1),i.abrupt("return",l.data);case 11:case"end":return i.stop()}},a)}));return function(n){return t.apply(this,arguments)}}();return(0,r.jsxs)(G._z,{children:[(0,r.jsx)(N.Z,{headerTitle:"\u7528\u6237\u5217\u8868",loading:m,actionRef:v,columns:le,request:ie,rowKey:"id",search:{labelWidth:"auto",defaultCollapsed:!1},pagination:{pageSize:5},toolBarRender:function(){return[(0,r.jsx)(W.ZP,{type:"primary",icon:(0,r.jsx)(J.Z,{}),onClick:function(){return V(!0)},children:"\u65B0\u5EFA\u7528\u6237"},"add")]}}),(0,r.jsx)(K.Z,{userId:c==null?void 0:c.id,userData:c==null?void 0:c.data,visible:B,onClose:function(){return F(!1)}}),(0,r.jsx)(q,{visible:ne,onCancel:function(){return V(!1)},onSuccess:se})]})},ae=re}}]);
