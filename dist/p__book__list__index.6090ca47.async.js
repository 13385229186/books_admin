"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[512],{5966:function($,D,e){var C=e(97685),o=e(1413),I=e(91),m=e(21770),g=e(8232),h=e(55241),E=e(98423),T=e(67294),k=e(79211),d=e(85893),p=["fieldProps","proFieldProps"],_=["fieldProps","proFieldProps"],R="text",A=function(c){var s=c.fieldProps,l=c.proFieldProps,r=(0,I.Z)(c,p);return(0,d.jsx)(k.Z,(0,o.Z)({valueType:R,fieldProps:s,filedConfig:{valueType:R},proFieldProps:l},r))},j=function(c){var s=(0,m.Z)(c.open||!1,{value:c.open,onChange:c.onOpenChange}),l=(0,C.Z)(s,2),r=l[0],a=l[1];return(0,d.jsx)(g.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(t){var i,M=t.getFieldValue(c.name||[]);return(0,d.jsx)(h.Z,(0,o.Z)((0,o.Z)({getPopupContainer:function(B){return B&&B.parentNode?B.parentNode:B},onOpenChange:function(B){return a(B)},content:(0,d.jsxs)("div",{style:{padding:"4px 0"},children:[(i=c.statusRender)===null||i===void 0?void 0:i.call(c,M),c.strengthText?(0,d.jsx)("div",{style:{marginTop:10},children:(0,d.jsx)("span",{children:c.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},c.popoverProps),{},{open:r,children:c.children}))}})},y=function(c){var s=c.fieldProps,l=c.proFieldProps,r=(0,I.Z)(c,_),a=(0,T.useState)(!1),n=(0,C.Z)(a,2),t=n[0],i=n[1];return s!=null&&s.statusRender&&r.name?(0,d.jsx)(j,{name:r.name,statusRender:s==null?void 0:s.statusRender,popoverProps:s==null?void 0:s.popoverProps,strengthText:s==null?void 0:s.strengthText,open:t,onOpenChange:i,children:(0,d.jsx)("div",{children:(0,d.jsx)(k.Z,(0,o.Z)({valueType:"password",fieldProps:(0,o.Z)((0,o.Z)({},(0,E.Z)(s,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(W){var B;s==null||(B=s.onBlur)===null||B===void 0||B.call(s,W),i(!1)},onClick:function(W){var B;s==null||(B=s.onClick)===null||B===void 0||B.call(s,W),i(!0)}}),proFieldProps:l,filedConfig:{valueType:R}},r))})}):(0,d.jsx)(k.Z,(0,o.Z)({valueType:"password",fieldProps:s,proFieldProps:l,filedConfig:{valueType:R}},r))},v=A;v.Password=y,v.displayName="ProFormComponent",D.Z=v},64540:function($,D,e){e.d(D,{Z:function(){return A}});var C=e(71471),o=e(83062),I=e(4393),m=e(51180),g=e(94272),h=e(28846),E=(0,h.kc)(function(j){var y=j.token;return{card:{position:"relative",borderRadius:"8px",transition:"all 0.3s ease",overflow:"hidden",".ant-card-cover":{position:"relative"},".ant-card-meta-title":{marginBottom:"4px","& > a":{display:"inline-block",maxWidth:"100%",color:y.colorTextHeading}},".ant-card-meta-description":{height:"44px",overflow:"hidden",lineHeight:"22px"},"&:hover":{".ant-card-meta-title > a":{color:y.colorPrimary}}},cardItemContent:{display:"flex",height:"20px",marginTop:"16px",marginBottom:"-4px",lineHeight:"20px","& > span":{flex:"1",color:y.colorTextSecondary,fontSize:"12px"}}}}),T=E,k=e(3826),d=e(58780),p=e(85893),_=C.Z.Paragraph,R=function(y){var v=y.data,L=y.showRecommendBadge,c=L===void 0?!1:L,s=y.rank,l=T(),r=l.styles,a=function(){var t,i;if(!c||!s||s>3)return null;var M=[{emoji:"\u{1F44D}",color:"#ffcc00"},{emoji:"\u{1F44D}",color:"#c0c0c0"},{emoji:"\u{1F44D}",color:"#cd7f32"}];return(0,p.jsx)(o.Z,{title:"\u63A8\u8350\u6307\u6570\u7B2C".concat(s,"\u540D"),children:(0,p.jsx)("div",{style:{position:"absolute",cursor:"pointer",top:10,right:20,fontSize:24,zIndex:10,textShadow:"0 0 8px ".concat(((t=M[s-1])===null||t===void 0?void 0:t.color)||"#999"),lineHeight:1},children:((i=M[s-1])===null||i===void 0?void 0:i.emoji)||"\u2B50"})})};return(0,p.jsxs)(p.Fragment,{children:[a(),(0,p.jsxs)(I.Z,{className:r.card,hoverable:!0,onClick:function(){(0,k.Cg)(v.id),g.history.push("/book/detail/".concat(v.id))},cover:v.cover?(0,p.jsx)("div",{style:{position:"relative"},children:(0,p.jsx)(m.Z,{style:{width:"100%",height:"200px",objectFit:"cover",objectPosition:"center",display:"block",borderTopLeftRadius:"10px",borderTopRightRadius:"10px"},preview:!1,src:(0,d.OR)(v.cover),alt:v.title})}):(0,p.jsx)("div",{style:{width:"100%",height:"200px",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"rgb(0.5, 0.5, 0.5, 0.2)"},children:"\u6682\u65E0\u5C01\u9762"}),children:[(0,p.jsx)(I.Z.Meta,{title:(0,p.jsx)("a",{children:v.title}),description:(0,p.jsx)(_,{ellipsis:{rows:2},children:v.intro||"\u6682\u65E0\u7B80\u4ECB"})}),(0,p.jsx)("div",{className:r.cardItemContent,children:(0,p.jsx)("span",{children:v.author})})]})]})},A=R},89588:function($,D,e){e.d(D,{L:function(){return C}});var C=[{value:"AVAILABLE",label:"\u53EF\u501F\u9605",badgeStatus:"success"},{value:"BORROWED",label:"\u5DF2\u501F\u5B8C",badgeStatus:"error"},{value:"MAINTENANCE",label:"\u6682\u505C\u501F\u9605",badgeStatus:"default"}]},37043:function($,D,e){e.r(D),e.d(D,{default:function(){return _e}});var C=e(15009),o=e.n(C),I=e(19632),m=e.n(I),g=e(97857),h=e.n(g),E=e(99289),T=e.n(E),k=e(5574),d=e.n(k),p=e(8232),_=e(71471),R=e(2453),A=e(4393),j=e(78045),y=e(71230),v=e(15746),L=e(83622),c=e(2487),s=e(74330),l=e(61370),r=e(4318),a=e(58780),n=e(9783),t=e.n(n),i=e(13769),M=e.n(i),W=e(93967),B=e.n(W),O=e(67294),pe=e(28846),je=(0,pe.kc)(function(K){var f=K.token;return{standardFormRow:{display:"flex",width:"100%",marginBottom:"16px",paddingBottom:"16px",borderBottom:"1px dashed ".concat(f.colorSplit),".ant-form-item, .ant-legacy-form-item":{marginRight:"24px"},".ant-form-item-label, .ant-legacy-form-item-label":{label:{marginRight:"0",color:f.colorText}},".ant-form-item-label, .ant-legacy-form-item-label, .ant-form-item-control, .ant-legacy-form-item-control":{padding:"0",lineHeight:"32px"}},label:{flex:"0 0 auto",marginRight:"24px",color:f.colorTextHeading,fontSize:f.fontSize,textAlign:"right","& > span":{display:"inline-block",height:"32px",lineHeight:"32px","&::after":{content:"'\uFF1A'"}}},content:{flex:"1 1 0",".ant-form-item, .ant-legacy-form-item":{"&:last-child":{display:"block",marginRight:"0"}}},standardFormRowLast:{marginBottom:"0",paddingBottom:"0",border:"none"},standardFormRowBlock:{".ant-form-item, .ant-legacy-form-item, div.ant-form-item-control-wrapper, div.ant-legacy-form-item-control-wrapper":{display:"block"}},standardFormRowGrid:{".ant-form-item, .ant-legacy-form-item, div.ant-form-item-control-wrapper, div.ant-legacy-form-item-control-wrapper":{display:"block"},".ant-form-item-label, .ant-legacy-form-item-label":{float:"left"}}}}),De=je,u=e(85893),Ce=["title","children","last","block","grid"],ke=function(f){var G=f.title,w=f.children,Y=f.last,N=f.block,U=f.grid,Z=M()(f,Ce),oe=De(),F=oe.styles,le=B()(F.standardFormRow,t()(t()(t()({},F.standardFormRowBlock,N),F.standardFormRowLast,Y),F.standardFormRowGrid,U));return(0,u.jsxs)("div",h()(h()({className:le},Z),{},{children:[G&&(0,u.jsx)("div",{className:F.label,children:(0,u.jsx)("span",{children:G})}),(0,u.jsx)("div",{className:F.content,children:w})]}))},ne=ke,Oe=(0,pe.kc)(function(K){var f=K.token;return{avatarList:{flex:"0 1 auto"},cardList:{marginTop:"24px"},coverCardList:{".ant-list .ant-list-item-content-single":{maxWidth:"100%"}},listContainer:{height:"calc(100vh - 300px)",overflowY:"auto",padding:"0 16px","&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-thumb":{backgroundColor:f.colorPrimary,borderRadius:"3px"},"&::-webkit-scrollbar-track":{backgroundColor:f.colorBgContainer}},loadingMore:{textAlign:"center",padding:"16px 0",color:f.colorTextSecondary}}}),Se=Oe,Ie=e(89588),ae=e(5966),Te=e(64540),me=p.Z.Item,Ve=_.Z.Paragraph,Le=function(f,G){var w;return function(){for(var Y=this,N=arguments.length,U=new Array(N),Z=0;Z<N;Z++)U[Z]=arguments[Z];w&&clearTimeout(w),w=setTimeout(function(){return f.apply(Y,U)},G)}},Ae=function(){var f=8,G=Se(),w=G.styles,Y=(0,O.useState)([]),N=d()(Y,2),U=N[0],Z=N[1],oe=(0,O.useState)([]),F=d()(oe,2),le=F[0],Fe=F[1],Me=(0,O.useState)(!1),ve=d()(Me,2),J=ve[0],fe=ve[1],we=p.Z.useForm(),Ze=d()(we,1),he=Ze[0],We=(0,O.useState)({}),ge=d()(We,2),Q=ge[0],Ne=ge[1],X=(0,O.useRef)(!1),Ue=(0,O.useState)(!1),ye=d()(Ue,2),$e=ye[0],be=ye[1],Ke=(0,O.useState)({current:1,pageSize:f,total:0,hasMore:!0}),xe=d()(Ke,2),q=xe[0],Ge=xe[1],ze=(0,O.useRef)(null),He=(0,O.useRef)(null),se=(0,O.useRef)(q);(0,O.useEffect)(function(){se.current=q},[q]);var V=(0,O.useCallback)(function(){var b=T()(o()().mark(function P(ee){var z,re,H,Pe,te,ie,Ee,ue,de,Re,ce=arguments;return o()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(z=ce.length>1&&ce[1]!==void 0?ce[1]:!1,!X.current){x.next=3;break}return x.abrupt("return");case 3:return X.current=!0,x.prev=4,re=z&&!J,re?be(!0):fe(!0),H=z?se.current.current+1:1,Pe=h()(h()(h()({},Q),ee),{},{current:H,pageSize:f}),x.next=11,(0,r.zl)((0,a.cz)(Pe));case 11:if(te=x.sent,te.status!=="fail"){x.next=15;break}return R.ZP.error(te.msg),x.abrupt("return");case 15:ie=te.data,Ee=ie.data,ue=ie.total,de=Ee.map(function(S){return{id:S.id,title:S.title,author:S.author,categoryId:S.categoryId,status:S.status,createdAt:S.createdAt,cover:S.cover,ebook:S.ebook,intro:S.intro,press:S.press,isbn:S.isbn,updatedAt:S.updatedAt}}),Z(function(S){return z?[].concat(m()(S),m()(de)):de}),Re={current:H,pageSize:f,total:ue,hasMore:H*f<ue},Ge(Re),x.next=26;break;case 22:x.prev=22,x.t0=x.catch(4),console.error("\u83B7\u53D6\u4E66\u7C4D\u5217\u8868\u5931\u8D25:",x.t0),R.ZP.error("\u83B7\u53D6\u4E66\u7C4D\u5217\u8868\u5931\u8D25");case 26:return x.prev=26,X.current=!1,fe(!1),be(!1),x.finish(26);case 31:case"end":return x.stop()}},P,null,[[4,22,26,31]])}));return function(P){return b.apply(this,arguments)}}(),[Q,J]);(0,O.useEffect)(function(){(0,l.A)().then(function(b){Fe(b.data.map(function(P){return{label:P.name,value:P.id}}))}),V({current:1,pageSize:f})},[]),(0,O.useEffect)(function(){var b=function(){var z=document.documentElement.scrollHeight,re=document.documentElement.scrollTop||document.body.scrollTop,H=document.documentElement.clientHeight;!X.current&&se.current.hasMore&&z-re<=H+200&&V({},!0)},P=Le(b,200);return window.addEventListener("scroll",P),function(){window.removeEventListener("scroll",P)}},[Q,V]);var Be=function(P){if("categoryId"in P||"status"in P){var ee=he.getFieldsValue();V(h()(h()({},Q),ee))}},Ye=function(P){Ne(P),V(P)};return(0,u.jsxs)("div",{className:w.coverCardList,children:[(0,u.jsx)(A.Z,{variant:"borderless",children:(0,u.jsxs)(p.Z,{form:he,layout:"inline",onValuesChange:Be,onFinish:Ye,initialValues:{categoryId:null,status:null},children:[(0,u.jsxs)("div",{onBlur:function(){return Be({})},style:{width:"100%"},children:[(0,u.jsx)(ne,{title:"\u6240\u5C5E\u7C7B\u76EE",block:!0,style:{paddingBottom:11},children:(0,u.jsx)(me,{name:"categoryId",children:(0,u.jsx)(j.ZP.Group,{block:!0,optionType:"button",buttonStyle:"solid",style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[{label:"\u5168\u90E8",value:null}].concat(m()(le)).map(function(b){return(0,u.jsx)(j.ZP.Button,{value:b.value,style:{whiteSpace:"nowrap",margin:0},children:b.label},b.value)})})})}),(0,u.jsx)(ne,{title:"\u53EF\u501F\u72B6\u6001",block:!0,style:{paddingBottom:11},children:(0,u.jsx)(me,{name:"status",children:(0,u.jsx)(j.ZP.Group,{block:!0,optionType:"button",buttonStyle:"solid",children:[{label:"\u5168\u90E8",value:null}].concat(m()(Ie.L)).map(function(b){return(0,u.jsx)(j.ZP.Button,{value:b.value,children:b.label},b.value)})})})})]}),(0,u.jsx)(ne,{title:"\u5176\u5B83\u9009\u9879",grid:!0,last:!0,children:(0,u.jsxs)(y.Z,{gutter:[16,16],style:{marginBottom:-16},children:[(0,u.jsx)(v.Z,{xl:7,lg:8,md:12,sm:12,xs:24,style:{paddingBottom:16},children:(0,u.jsx)(ae.Z,{label:"\u4E66\u540D",name:"title",placeholder:"\u8BF7\u8F93\u5165\u4E66\u540D"})}),(0,u.jsx)(v.Z,{xl:7,lg:8,md:12,sm:12,xs:24,style:{paddingBottom:16},children:(0,u.jsx)(ae.Z,{label:"\u4F5C\u8005",name:"author",placeholder:"\u8BF7\u8F93\u5165\u4F5C\u8005"})}),(0,u.jsx)(v.Z,{xl:7,lg:8,md:12,sm:12,xs:24,style:{paddingBottom:16},children:(0,u.jsx)(ae.Z,{label:"\u51FA\u7248\u793E",name:"press",placeholder:"\u8BF7\u8F93\u5165\u51FA\u7248\u793E"})}),(0,u.jsx)(v.Z,{xl:3,lg:8,md:12,sm:12,xs:24,style:{paddingBottom:16},children:(0,u.jsx)(L.ZP,{type:"primary",htmlType:"submit",loading:J,style:{float:"right"},children:"\u641C\u7D22"})})]})})]})}),(0,u.jsxs)("div",{className:w.cardList,ref:He,children:[(0,u.jsx)(c.Z,{rowKey:"id",loading:J,grid:{gutter:16,xs:1,sm:2,md:3,lg:3,xl:4,xxl:4},dataSource:U,renderItem:function(P){return(0,u.jsx)(c.Z.Item,{children:(0,u.jsx)(Te.Z,{data:P})})}}),(0,u.jsxs)("div",{ref:ze,children:[$e&&(0,u.jsxs)("div",{style:{textAlign:"center",padding:"16px 0"},children:[(0,u.jsx)(s.Z,{size:"small"}),(0,u.jsx)("span",{style:{marginLeft:8},children:"\u52A0\u8F7D\u66F4\u591A..."})]}),!q.hasMore&&U.length>0&&(0,u.jsx)("div",{style:{textAlign:"center",padding:"16px 0",color:"#999"},children:"\u6CA1\u6709\u66F4\u591A\u6570\u636E\u4E86"})]})]})]})},_e=Ae},4318:function($,D,e){e.d(D,{P4:function(){return A},ak:function(){return T},i8:function(){return s},qU:function(){return y},u8:function(){return d},zl:function(){return h}});var C=e(15009),o=e.n(C),I=e(99289),m=e.n(I),g=e(71052);function h(r){return E.apply(this,arguments)}function E(){return E=m()(o()().mark(function r(a){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,g.h)("/api/user/bookList",a));case 1:case"end":return t.stop()}},r)})),E.apply(this,arguments)}function T(r){return k.apply(this,arguments)}function k(){return k=m()(o()().mark(function r(a){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,g.x)("/api/admin/bookUpload",{},{file:a.file,cover:a.cover},{data:a.bookData,fieldName:"bookData"}));case 1:case"end":return t.stop()}},r)})),k.apply(this,arguments)}function d(r){return p.apply(this,arguments)}function p(){return p=m()(o()().mark(function r(a){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,g.x)("/api/admin/updateBook",{bookId:a.bookId},{file:a.file,cover:a.cover},{data:a.bookData,fieldName:"bookData"}));case 1:case"end":return t.stop()}},r)})),p.apply(this,arguments)}function _(r){return R.apply(this,arguments)}function R(){return R=_asyncToGenerator(_regeneratorRuntime().mark(function r(a){var n;return _regeneratorRuntime().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n=new FormData,n.append("bookId",a.bookId),i.abrupt("return",api("/api/admin/deleteBook",n));case 3:case"end":return i.stop()}},r)})),R.apply(this,arguments)}function A(r){return j.apply(this,arguments)}function j(){return j=m()(o()().mark(function r(a){var n;return o()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n=new FormData,n.append("bookId",a.bookId),i.abrupt("return",(0,g.h)("/api/user/getBookById",n));case 3:case"end":return i.stop()}},r)})),j.apply(this,arguments)}function y(r){return v.apply(this,arguments)}function v(){return v=m()(o()().mark(function r(a){var n;return o()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n=new FormData,n.append("bookId",a.bookId),i.abrupt("return",(0,g.h)("/api/user/getBookNumberById",n));case 3:case"end":return i.stop()}},r)})),v.apply(this,arguments)}function L(r){return c.apply(this,arguments)}function c(){return c=_asyncToGenerator(_regeneratorRuntime().mark(function r(a){var n;return _regeneratorRuntime().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n=new FormData,n.append("bookId",a.bookId),n.append("bookNumber",a.bookNumber),i.abrupt("return",api("/api/admin/setBookNumber",a));case 4:case"end":return i.stop()}},r)})),c.apply(this,arguments)}function s(r){return l.apply(this,arguments)}function l(){return l=m()(o()().mark(function r(a){var n;return o()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n=new FormData,n.append("CategoryName",a.CategoryName),i.abrupt("return",(0,g.h)("/api/admin/addCategory",n));case 3:case"end":return i.stop()}},r)})),l.apply(this,arguments)}},61370:function($,D,e){e.d(D,{A:function(){return h}});var C=e(15009),o=e.n(C),I=e(99289),m=e.n(I),g=e(71052);function h(){return E.apply(this,arguments)}function E(){return E=m()(o()().mark(function T(){return o()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,g.h)("/api/user/categoryList",{}));case 1:case"end":return d.stop()}},T)})),E.apply(this,arguments)}},3826:function($,D,e){e.d(D,{pF:function(){return k},DY:function(){return E},zO:function(){return c},Iq:function(){return v},Ym:function(){return j},Cg:function(){return R}});var C=e(15009),o=e.n(C),I=e(99289),m=e.n(I),g=e(71052),h=function(l){return l.VIEW="VIEW",l.READ_ONLINE="READ_ONLINE",l.DOWNLOAD="DOWNLOAD",l.BORROW="BORROW",l}({});function E(l){return T.apply(this,arguments)}function T(){return T=m()(o()().mark(function l(r){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,g.h)("/api/user/recommendations",r));case 1:case"end":return n.stop()}},l)})),T.apply(this,arguments)}function k(l){return d.apply(this,arguments)}function d(){return d=m()(o()().mark(function l(r){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,g.h)("/api/user/hotBookList",r));case 1:case"end":return n.stop()}},l)})),d.apply(this,arguments)}function p(l){return _.apply(this,arguments)}function _(){return _=m()(o()().mark(function l(r){return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,g.h)("/api/user/recordBehavior",r));case 1:case"end":return n.stop()}},l)})),_.apply(this,arguments)}function R(l){return A.apply(this,arguments)}function A(){return A=m()(o()().mark(function l(r){var a;return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={bookId:r,behaviorType:h.VIEW},t.abrupt("return",p(a));case 2:case"end":return t.stop()}},l)})),A.apply(this,arguments)}function j(l){return y.apply(this,arguments)}function y(){return y=m()(o()().mark(function l(r){var a;return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={bookId:r,behaviorType:h.READ_ONLINE},t.abrupt("return",p(a));case 2:case"end":return t.stop()}},l)})),y.apply(this,arguments)}function v(l){return L.apply(this,arguments)}function L(){return L=m()(o()().mark(function l(r){var a;return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={bookId:r,behaviorType:h.DOWNLOAD},t.abrupt("return",p(a));case 2:case"end":return t.stop()}},l)})),L.apply(this,arguments)}function c(l){return s.apply(this,arguments)}function s(){return s=m()(o()().mark(function l(r){var a;return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={bookId:r,behaviorType:h.BORROW},t.abrupt("return",p(a));case 2:case"end":return t.stop()}},l)})),s.apply(this,arguments)}}}]);
