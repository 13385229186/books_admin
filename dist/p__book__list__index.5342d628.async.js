"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[512],{5966:function(U,D,e){var C=e(97685),o=e(1413),I=e(91),p=e(21770),h=e(8232),f=e(55241),R=e(98423),T=e(67294),k=e(79211),l=e(85893),B=["fieldProps","proFieldProps"],A=["fieldProps","proFieldProps"],j="text",L=function(c){var u=c.fieldProps,s=c.proFieldProps,n=(0,I.Z)(c,B);return(0,l.jsx)(k.Z,(0,o.Z)({valueType:j,fieldProps:u,filedConfig:{valueType:j},proFieldProps:s},n))},v=function(c){var u=(0,p.Z)(c.open||!1,{value:c.open,onChange:c.onOpenChange}),s=(0,C.Z)(u,2),n=s[0],a=s[1];return(0,l.jsx)(h.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(t){var i,H=t.getFieldValue(c.name||[]);return(0,l.jsx)(f.Z,(0,o.Z)((0,o.Z)({getPopupContainer:function(P){return P&&P.parentNode?P.parentNode:P},onOpenChange:function(P){return a(P)},content:(0,l.jsxs)("div",{style:{padding:"4px 0"},children:[(i=c.statusRender)===null||i===void 0?void 0:i.call(c,H),c.strengthText?(0,l.jsx)("div",{style:{marginTop:10},children:(0,l.jsx)("span",{children:c.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},c.popoverProps),{},{open:n,children:c.children}))}})},g=function(c){var u=c.fieldProps,s=c.proFieldProps,n=(0,I.Z)(c,A),a=(0,T.useState)(!1),r=(0,C.Z)(a,2),t=r[0],i=r[1];return u!=null&&u.statusRender&&n.name?(0,l.jsx)(v,{name:n.name,statusRender:u==null?void 0:u.statusRender,popoverProps:u==null?void 0:u.popoverProps,strengthText:u==null?void 0:u.strengthText,open:t,onOpenChange:i,children:(0,l.jsx)("div",{children:(0,l.jsx)(k.Z,(0,o.Z)({valueType:"password",fieldProps:(0,o.Z)((0,o.Z)({},(0,R.Z)(u,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(Z){var P;u==null||(P=u.onBlur)===null||P===void 0||P.call(u,Z),i(!1)},onClick:function(Z){var P;u==null||(P=u.onClick)===null||P===void 0||P.call(u,Z),i(!0)}}),proFieldProps:s,filedConfig:{valueType:j}},n))})}):(0,l.jsx)(k.Z,(0,o.Z)({valueType:"password",fieldProps:u,proFieldProps:s,filedConfig:{valueType:j}},n))},y=L;y.Password=g,y.displayName="ProFormComponent",D.Z=y},64540:function(U,D,e){e.d(D,{Z:function(){return j}});var C=e(71471),o=e(83062),I=e(4393),p=e(94272),h=e(28846),f=(0,h.kc)(function(L){var v=L.token;return{card:{position:"relative",borderRadius:"8px",transition:"all 0.3s ease",overflow:"hidden",".ant-card-cover":{position:"relative"},".ant-card-meta-title":{marginBottom:"4px","& > a":{display:"inline-block",maxWidth:"100%",color:v.colorTextHeading}},".ant-card-meta-description":{height:"44px",overflow:"hidden",lineHeight:"22px"},"&:hover":{".ant-card-meta-title > a":{color:v.colorPrimary}}},cardItemContent:{display:"flex",height:"20px",marginTop:"16px",marginBottom:"-4px",lineHeight:"20px","& > span":{flex:"1",color:v.colorTextSecondary,fontSize:"12px"}}}}),R=f,T=e(3826),k=e(58780),l=e(85893),B=C.Z.Paragraph,A=function(v){var g=v.data,y=v.showRecommendBadge,_=y===void 0?!1:y,c=v.rank,u=R(),s=u.styles,n=function(){var r,t;if(!_||!c||c>3)return null;var i=[{emoji:"\u{1F44D}",color:"#ffcc00"},{emoji:"\u{1F44D}",color:"#c0c0c0"},{emoji:"\u{1F44D}",color:"#cd7f32"}];return(0,l.jsx)(o.Z,{title:"\u63A8\u8350\u6307\u6570\u7B2C".concat(c,"\u540D"),children:(0,l.jsx)("div",{style:{position:"absolute",cursor:"pointer",top:10,right:20,fontSize:24,zIndex:10,textShadow:"0 0 8px ".concat(((r=i[c-1])===null||r===void 0?void 0:r.color)||"#999"),lineHeight:1},children:((t=i[c-1])===null||t===void 0?void 0:t.emoji)||"\u2B50"})})};return(0,l.jsxs)(l.Fragment,{children:[n(),(0,l.jsxs)(I.Z,{className:s.card,hoverable:!0,onClick:function(){(0,T.Cg)(g.id),p.history.push("/book/detail/".concat(g.id))},cover:g.cover?(0,l.jsx)("div",{style:{position:"relative"},children:(0,l.jsx)("img",{style:{width:"100%",height:"200px",objectFit:"cover",objectPosition:"center",display:"block",borderTopLeftRadius:"10px",borderTopRightRadius:"10px"},alt:g.title+"\u5C01\u9762\u52A0\u8F7D\u4E2D...",src:(0,k.OR)(g.cover)})}):(0,l.jsx)("div",{style:{width:"100%",height:"200px",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"rgb(0.5, 0.5, 0.5, 0.2)"},children:"\u6682\u65E0\u5C01\u9762"}),children:[(0,l.jsx)(I.Z.Meta,{title:(0,l.jsx)("a",{children:g.title}),description:(0,l.jsx)(B,{ellipsis:{rows:2},children:g.intro||"\u6682\u65E0\u7B80\u4ECB"})}),(0,l.jsx)("div",{className:s.cardItemContent,children:(0,l.jsx)("span",{children:g.author})})]})]})},j=A},89588:function(U,D,e){e.d(D,{L:function(){return C}});var C=[{value:"AVAILABLE",label:"\u53EF\u501F\u9605",badgeStatus:"success"},{value:"BORROWED",label:"\u5DF2\u501F\u5B8C",badgeStatus:"error"},{value:"MAINTENANCE",label:"\u6682\u505C\u501F\u9605",badgeStatus:"default"}]},37043:function(U,D,e){e.r(D),e.d(D,{default:function(){return Ae}});var C=e(15009),o=e.n(C),I=e(19632),p=e.n(I),h=e(97857),f=e.n(h),R=e(99289),T=e.n(R),k=e(5574),l=e.n(k),B=e(8232),A=e(71471),j=e(2453),L=e(4393),v=e(78045),g=e(71230),y=e(15746),_=e(83622),c=e(2487),u=e(74330),s=e(61370),n=e(4318),a=e(58780),r=e(9783),t=e.n(r),i=e(13769),H=e.n(i),Z=e(93967),P=e.n(Z),O=e(67294),pe=e(28846),je=(0,pe.kc)(function($){var m=$.token;return{standardFormRow:{display:"flex",width:"100%",marginBottom:"16px",paddingBottom:"16px",borderBottom:"1px dashed ".concat(m.colorSplit),".ant-form-item, .ant-legacy-form-item":{marginRight:"24px"},".ant-form-item-label, .ant-legacy-form-item-label":{label:{marginRight:"0",color:m.colorText}},".ant-form-item-label, .ant-legacy-form-item-label, .ant-form-item-control, .ant-legacy-form-item-control":{padding:"0",lineHeight:"32px"}},label:{flex:"0 0 auto",marginRight:"24px",color:m.colorTextHeading,fontSize:m.fontSize,textAlign:"right","& > span":{display:"inline-block",height:"32px",lineHeight:"32px","&::after":{content:"'\uFF1A'"}}},content:{flex:"1 1 0",".ant-form-item, .ant-legacy-form-item":{"&:last-child":{display:"block",marginRight:"0"}}},standardFormRowLast:{marginBottom:"0",paddingBottom:"0",border:"none"},standardFormRowBlock:{".ant-form-item, .ant-legacy-form-item, div.ant-form-item-control-wrapper, div.ant-legacy-form-item-control-wrapper":{display:"block"}},standardFormRowGrid:{".ant-form-item, .ant-legacy-form-item, div.ant-form-item-control-wrapper, div.ant-legacy-form-item-control-wrapper":{display:"block"},".ant-form-item-label, .ant-legacy-form-item-label":{float:"left"}}}}),De=je,d=e(85893),Ce=["title","children","last","block","grid"],ke=function(m){var K=m.title,M=m.children,Y=m.last,W=m.block,N=m.grid,w=H()(m,Ce),oe=De(),F=oe.styles,le=P()(F.standardFormRow,t()(t()(t()({},F.standardFormRowBlock,W),F.standardFormRowLast,Y),F.standardFormRowGrid,N));return(0,d.jsxs)("div",f()(f()({className:le},w),{},{children:[K&&(0,d.jsx)("div",{className:F.label,children:(0,d.jsx)("span",{children:K})}),(0,d.jsx)("div",{className:F.content,children:M})]}))},ne=ke,Oe=(0,pe.kc)(function($){var m=$.token;return{avatarList:{flex:"0 1 auto"},cardList:{marginTop:"24px"},coverCardList:{".ant-list .ant-list-item-content-single":{maxWidth:"100%"}},listContainer:{height:"calc(100vh - 300px)",overflowY:"auto",padding:"0 16px","&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-thumb":{backgroundColor:m.colorPrimary,borderRadius:"3px"},"&::-webkit-scrollbar-track":{backgroundColor:m.colorBgContainer}},loadingMore:{textAlign:"center",padding:"16px 0",color:m.colorTextSecondary}}}),Se=Oe,Ie=e(89588),ae=e(5966),Te=e(64540),me=B.Z.Item,Ve=A.Z.Paragraph,Le=function(m,K){var M;return function(){for(var Y=this,W=arguments.length,N=new Array(W),w=0;w<W;w++)N[w]=arguments[w];M&&clearTimeout(M),M=setTimeout(function(){return m.apply(Y,N)},K)}},_e=function(){var m=8,K=Se(),M=K.styles,Y=(0,O.useState)([]),W=l()(Y,2),N=W[0],w=W[1],oe=(0,O.useState)([]),F=l()(oe,2),le=F[0],Fe=F[1],Me=(0,O.useState)(!1),fe=l()(Me,2),J=fe[0],ve=fe[1],we=B.Z.useForm(),Ze=l()(we,1),he=Ze[0],We=(0,O.useState)({}),ge=l()(We,2),Q=ge[0],Ne=ge[1],X=(0,O.useRef)(!1),Ue=(0,O.useState)(!1),ye=l()(Ue,2),$e=ye[0],be=ye[1],Ke=(0,O.useState)({current:1,pageSize:m,total:0,hasMore:!0}),xe=l()(Ke,2),q=xe[0],Ge=xe[1],ze=(0,O.useRef)(null),He=(0,O.useRef)(null),se=(0,O.useRef)(q);(0,O.useEffect)(function(){se.current=q},[q]);var V=(0,O.useCallback)(function(){var b=T()(o()().mark(function E(ee){var G,re,z,Pe,te,ie,Ee,ue,de,Re,ce=arguments;return o()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(G=ce.length>1&&ce[1]!==void 0?ce[1]:!1,!X.current){x.next=3;break}return x.abrupt("return");case 3:return X.current=!0,x.prev=4,re=G&&!J,re?be(!0):ve(!0),z=G?se.current.current+1:1,Pe=f()(f()(f()({},Q),ee),{},{current:z,pageSize:m}),x.next=11,(0,n.zl)((0,a.cz)(Pe));case 11:if(te=x.sent,te.status!=="fail"){x.next=15;break}return j.ZP.error(te.msg),x.abrupt("return");case 15:ie=te.data,Ee=ie.data,ue=ie.total,de=Ee.map(function(S){return{id:S.id,title:S.title,author:S.author,categoryId:S.categoryId,status:S.status,createdAt:S.createdAt,cover:S.cover,ebook:S.ebook,intro:S.intro,press:S.press,isbn:S.isbn,updatedAt:S.updatedAt}}),w(function(S){return G?[].concat(p()(S),p()(de)):de}),Re={current:z,pageSize:m,total:ue,hasMore:z*m<ue},Ge(Re),x.next=26;break;case 22:x.prev=22,x.t0=x.catch(4),console.error("\u83B7\u53D6\u4E66\u7C4D\u5217\u8868\u5931\u8D25:",x.t0),j.ZP.error("\u83B7\u53D6\u4E66\u7C4D\u5217\u8868\u5931\u8D25");case 26:return x.prev=26,X.current=!1,ve(!1),be(!1),x.finish(26);case 31:case"end":return x.stop()}},E,null,[[4,22,26,31]])}));return function(E){return b.apply(this,arguments)}}(),[Q,J]);(0,O.useEffect)(function(){(0,s.A)().then(function(b){Fe(b.data.map(function(E){return{label:E.name,value:E.id}}))}),V({current:1,pageSize:m})},[]),(0,O.useEffect)(function(){var b=function(){var G=document.documentElement.scrollHeight,re=document.documentElement.scrollTop||document.body.scrollTop,z=document.documentElement.clientHeight;!X.current&&se.current.hasMore&&G-re<=z+200&&V({},!0)},E=Le(b,200);return window.addEventListener("scroll",E),function(){window.removeEventListener("scroll",E)}},[Q,V]);var Be=function(E){if("categoryId"in E||"status"in E){var ee=he.getFieldsValue();V(f()(f()({},Q),ee))}},Ye=function(E){Ne(E),V(E)};return(0,d.jsxs)("div",{className:M.coverCardList,children:[(0,d.jsx)(L.Z,{variant:"borderless",children:(0,d.jsxs)(B.Z,{form:he,layout:"inline",onValuesChange:Be,onFinish:Ye,initialValues:{categoryId:null,status:null},children:[(0,d.jsxs)("div",{onBlur:function(){return Be({})},style:{width:"100%"},children:[(0,d.jsx)(ne,{title:"\u6240\u5C5E\u7C7B\u76EE",block:!0,style:{paddingBottom:11},children:(0,d.jsx)(me,{name:"categoryId",children:(0,d.jsx)(v.ZP.Group,{block:!0,optionType:"button",buttonStyle:"solid",style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[{label:"\u5168\u90E8",value:null}].concat(p()(le)).map(function(b){return(0,d.jsx)(v.ZP.Button,{value:b.value,style:{whiteSpace:"nowrap",margin:0},children:b.label},b.value)})})})}),(0,d.jsx)(ne,{title:"\u53EF\u501F\u72B6\u6001",block:!0,style:{paddingBottom:11},children:(0,d.jsx)(me,{name:"status",children:(0,d.jsx)(v.ZP.Group,{block:!0,optionType:"button",buttonStyle:"solid",children:[{label:"\u5168\u90E8",value:null}].concat(p()(Ie.L)).map(function(b){return(0,d.jsx)(v.ZP.Button,{value:b.value,children:b.label},b.value)})})})})]}),(0,d.jsx)(ne,{title:"\u5176\u5B83\u9009\u9879",grid:!0,last:!0,children:(0,d.jsxs)(g.Z,{gutter:[16,16],style:{marginBottom:-16},children:[(0,d.jsx)(y.Z,{xl:7,lg:8,md:12,sm:12,xs:24,style:{paddingBottom:16},children:(0,d.jsx)(ae.Z,{label:"\u4E66\u540D",name:"title",placeholder:"\u8BF7\u8F93\u5165\u4E66\u540D"})}),(0,d.jsx)(y.Z,{xl:7,lg:8,md:12,sm:12,xs:24,style:{paddingBottom:16},children:(0,d.jsx)(ae.Z,{label:"\u4F5C\u8005",name:"author",placeholder:"\u8BF7\u8F93\u5165\u4F5C\u8005"})}),(0,d.jsx)(y.Z,{xl:7,lg:8,md:12,sm:12,xs:24,style:{paddingBottom:16},children:(0,d.jsx)(ae.Z,{label:"\u51FA\u7248\u793E",name:"press",placeholder:"\u8BF7\u8F93\u5165\u51FA\u7248\u793E"})}),(0,d.jsx)(y.Z,{xl:3,lg:8,md:12,sm:12,xs:24,style:{paddingBottom:16},children:(0,d.jsx)(_.ZP,{type:"primary",htmlType:"submit",loading:J,style:{float:"right"},children:"\u641C\u7D22"})})]})})]})}),(0,d.jsxs)("div",{className:M.cardList,ref:He,children:[(0,d.jsx)(c.Z,{rowKey:"id",loading:J,grid:{gutter:16,xs:1,sm:2,md:3,lg:3,xl:4,xxl:4},dataSource:N,renderItem:function(E){return(0,d.jsx)(c.Z.Item,{children:(0,d.jsx)(Te.Z,{data:E})})}}),(0,d.jsxs)("div",{ref:ze,children:[$e&&(0,d.jsxs)("div",{style:{textAlign:"center",padding:"16px 0"},children:[(0,d.jsx)(u.Z,{size:"small"}),(0,d.jsx)("span",{style:{marginLeft:8},children:"\u52A0\u8F7D\u66F4\u591A..."})]}),!q.hasMore&&N.length>0&&(0,d.jsx)("div",{style:{textAlign:"center",padding:"16px 0",color:"#999"},children:"\u6CA1\u6709\u66F4\u591A\u6570\u636E\u4E86"})]})]})]})},Ae=_e},4318:function(U,D,e){e.d(D,{P4:function(){return L},ak:function(){return T},i8:function(){return u},qU:function(){return g},u8:function(){return l},zl:function(){return f}});var C=e(15009),o=e.n(C),I=e(99289),p=e.n(I),h=e(71052);function f(n){return R.apply(this,arguments)}function R(){return R=p()(o()().mark(function n(a){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,h.h)("/api/user/bookList",a));case 1:case"end":return t.stop()}},n)})),R.apply(this,arguments)}function T(n){return k.apply(this,arguments)}function k(){return k=p()(o()().mark(function n(a){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,h.x)("/api/admin/bookUpload",{},{file:a.file,cover:a.cover},{data:a.bookData,fieldName:"bookData"}));case 1:case"end":return t.stop()}},n)})),k.apply(this,arguments)}function l(n){return B.apply(this,arguments)}function B(){return B=p()(o()().mark(function n(a){return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,h.x)("/api/admin/updateBook",{bookId:a.bookId},{file:a.file,cover:a.cover},{data:a.bookData,fieldName:"bookData"}));case 1:case"end":return t.stop()}},n)})),B.apply(this,arguments)}function A(n){return j.apply(this,arguments)}function j(){return j=_asyncToGenerator(_regeneratorRuntime().mark(function n(a){var r;return _regeneratorRuntime().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=new FormData,r.append("bookId",a.bookId),i.abrupt("return",api("/api/admin/deleteBook",r));case 3:case"end":return i.stop()}},n)})),j.apply(this,arguments)}function L(n){return v.apply(this,arguments)}function v(){return v=p()(o()().mark(function n(a){var r;return o()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=new FormData,r.append("bookId",a.bookId),i.abrupt("return",(0,h.h)("/api/user/getBookById",r));case 3:case"end":return i.stop()}},n)})),v.apply(this,arguments)}function g(n){return y.apply(this,arguments)}function y(){return y=p()(o()().mark(function n(a){var r;return o()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=new FormData,r.append("bookId",a.bookId),i.abrupt("return",(0,h.h)("/api/user/getBookNumberById",r));case 3:case"end":return i.stop()}},n)})),y.apply(this,arguments)}function _(n){return c.apply(this,arguments)}function c(){return c=_asyncToGenerator(_regeneratorRuntime().mark(function n(a){var r;return _regeneratorRuntime().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=new FormData,r.append("bookId",a.bookId),r.append("bookNumber",a.bookNumber),i.abrupt("return",api("/api/admin/setBookNumber",a));case 4:case"end":return i.stop()}},n)})),c.apply(this,arguments)}function u(n){return s.apply(this,arguments)}function s(){return s=p()(o()().mark(function n(a){var r;return o()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r=new FormData,r.append("CategoryName",a.CategoryName),i.abrupt("return",(0,h.h)("/api/admin/addCategory",r));case 3:case"end":return i.stop()}},n)})),s.apply(this,arguments)}},61370:function(U,D,e){e.d(D,{A:function(){return f}});var C=e(15009),o=e.n(C),I=e(99289),p=e.n(I),h=e(71052);function f(){return R.apply(this,arguments)}function R(){return R=p()(o()().mark(function T(){return o()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,h.h)("/api/user/categoryList",{}));case 1:case"end":return l.stop()}},T)})),R.apply(this,arguments)}},3826:function(U,D,e){e.d(D,{pF:function(){return k},DY:function(){return R},zO:function(){return c},Iq:function(){return y},Ym:function(){return v},Cg:function(){return j}});var C=e(15009),o=e.n(C),I=e(99289),p=e.n(I),h=e(71052),f=function(s){return s.VIEW="VIEW",s.READ_ONLINE="READ_ONLINE",s.DOWNLOAD="DOWNLOAD",s.BORROW="BORROW",s}({});function R(s){return T.apply(this,arguments)}function T(){return T=p()(o()().mark(function s(n){return o()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,h.h)("/api/user/recommendations",n));case 1:case"end":return r.stop()}},s)})),T.apply(this,arguments)}function k(s){return l.apply(this,arguments)}function l(){return l=p()(o()().mark(function s(n){return o()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,h.h)("/api/user/hotBookList",n));case 1:case"end":return r.stop()}},s)})),l.apply(this,arguments)}function B(s){return A.apply(this,arguments)}function A(){return A=p()(o()().mark(function s(n){return o()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,h.h)("/api/user/recordBehavior",n));case 1:case"end":return r.stop()}},s)})),A.apply(this,arguments)}function j(s){return L.apply(this,arguments)}function L(){return L=p()(o()().mark(function s(n){var a;return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={bookId:n,behaviorType:f.VIEW},t.abrupt("return",B(a));case 2:case"end":return t.stop()}},s)})),L.apply(this,arguments)}function v(s){return g.apply(this,arguments)}function g(){return g=p()(o()().mark(function s(n){var a;return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={bookId:n,behaviorType:f.READ_ONLINE},t.abrupt("return",B(a));case 2:case"end":return t.stop()}},s)})),g.apply(this,arguments)}function y(s){return _.apply(this,arguments)}function _(){return _=p()(o()().mark(function s(n){var a;return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={bookId:n,behaviorType:f.DOWNLOAD},t.abrupt("return",B(a));case 2:case"end":return t.stop()}},s)})),_.apply(this,arguments)}function c(s){return u.apply(this,arguments)}function u(){return u=p()(o()().mark(function s(n){var a;return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={bookId:n,behaviorType:f.BORROW},t.abrupt("return",B(a));case 2:case"end":return t.stop()}},s)})),u.apply(this,arguments)}}}]);
