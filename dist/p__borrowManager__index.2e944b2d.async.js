"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[35],{96105:function(ue,v,r){r.r(v);var A=r(15009),D=r.n(A),U=r(99289),E=r.n(U),L=r(5574),o=r.n(L),j=r(90930),K=r(73580),W=r(8232),f=r(2453),w=r(83622),y=r(66309),h=r(40614),i=r(67294),m=r(58780),Y=r(20780),p=r(34666),Z=r(93409),_=r(85893),k=function(){var F=W.Z.useForm(),J=o()(F,1),oe=J[0],P=(0,i.useRef)(),$=(0,i.useState)(null),M=o()($,2),V=M[0],z=M[1],G=(0,i.useState)(null),T=o()(G,2),d=T[0],X=T[1],x=(0,i.useState)(!1),b=o()(x,2),H=b[0],I=b[1],N=(0,i.useState)(!1),O=o()(N,2),ie=O[0],C=O[1],Q=(0,i.useState)(!1),S=o()(Q,2),q=S[0],B=S[1],ee=(0,i.useState)(!1),g=o()(ee,2),re=g[0],R=g[1],ae=function(t,e){X({id:t,data:e}),I(!0)},te=function(t){z(t),R(!0)},se=function(){var u=E()(D()().mark(function t(e,s){var c,a;return D()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,C(!0),l.next=4,(0,h.XG)({id:e,status:s});case 4:c=l.sent,c.status==="success"?(f.ZP.success("\u72B6\u6001\u66F4\u65B0\u6210\u529F"),(a=P.current)===null||a===void 0||a.reload()):f.ZP.error(c.msg||"\u64CD\u4F5C\u5931\u8D25"),l.next=12;break;case 8:l.prev=8,l.t0=l.catch(0),console.error("\u64CD\u4F5C\u5931\u8D25:",l.t0),f.ZP.error("\u64CD\u4F5C\u5931\u8D25");case 12:return l.prev=12,C(!1),l.finish(12);case 15:case"end":return l.stop()}},t,null,[[0,8,12,15]])}));return function(e,s){return u.apply(this,arguments)}}(),ne=[{title:"ID",dataIndex:"id",width:60},{title:"\u7528\u6237",dataIndex:"name",width:150,render:function(t,e){return(0,_.jsx)(w.ZP,{type:"link",onClick:function(){return ae(e.userId)},style:{padding:0,textAlign:"left"},children:(0,_.jsxs)("div",{children:[(0,_.jsx)("div",{children:e.name}),(0,_.jsx)("div",{style:{color:"#888"},children:e.phone})]})})}},{title:"\u624B\u673A\u53F7",dataIndex:"phone",hideInTable:!0},{title:"\u4E66\u540D",dataIndex:"title",ellipsis:!0},{title:"\u501F\u9605\u65F6\u95F4",dataIndex:"borrowTime",valueType:"date",hideInSearch:!1,fieldProps:{format:"YYYY-MM-DD"},render:function(t,e){return e.borrowTime?(0,m.o0)(new Date(e.borrowTime)):"-"}},{title:"\u5E94\u8FD8\u65F6\u95F4",dataIndex:"dueTime",valueType:"date",hideInSearch:!1,fieldProps:{format:"YYYY-MM-DD"},render:function(t,e){return e.dueTime?(0,m.o0)(new Date(e.dueTime)):"-"}},{title:"\u72B6\u6001",dataIndex:"status",valueType:"select",fieldProps:{options:p.S},render:function(t,e){var s=p.S.find(function(c){return c.value===e.status});return s?(0,_.jsx)(y.Z,{color:s.color,children:s.label||e.status}):"\u672A\u77E5\u72B6\u6001: ".concat(e.status)}},{title:"\u64CD\u4F5C",valueType:"option",width:70,render:function(t,e){return(0,_.jsx)("a",{type:"link",onClick:function(){return te(e)},children:"\u8BE6\u60C5"},"detail")}}],le=function(){var u=E()(D()().mark(function t(e){var s;return D()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=(0,m.cz)(e),B(!0),a.prev=2,a.next=5,(0,h.Zl)(e);case 5:if(s=a.sent,s.status!=="fail"){a.next=9;break}return f.ZP.error(s.msg),a.abrupt("return",{data:[],success:!1});case 9:return a.abrupt("return",{data:s.data.data.map(function(n){return{id:n.id,name:n.name,phone:n.phone,title:n.title,status:n.status,borrowTime:n.borrowTime,dueTime:n.dueTime,userId:n.userId,bookId:n.bookId,borrowDays:n.borrowDays,createdAt:n.createdAt,returnTime:n.returnTime}}),total:s.data.total,success:!0});case 12:return a.prev=12,a.t0=a.catch(2),console.error("\u83B7\u53D6\u501F\u9605\u5217\u8868\u5931\u8D25:",a.t0),f.ZP.error("\u83B7\u53D6\u501F\u9605\u5217\u8868\u5931\u8D25"),a.abrupt("return",{data:[],success:!1});case 17:return a.prev=17,B(!1),a.finish(17);case 20:case"end":return a.stop()}},t,null,[[2,12,17,20]])}));return function(e){return u.apply(this,arguments)}}();return(0,_.jsxs)(j._z,{children:[(0,_.jsx)(K.Z,{headerTitle:"\u501F\u9605\u5217\u8868",actionRef:P,columns:ne,loading:q,request:le,rowKey:"id",search:{labelWidth:"auto",defaultCollapsed:!1},pagination:{pageSize:5},dateFormatter:"string"}),(0,_.jsx)(Y.Z,{userId:d==null?void 0:d.id,userData:d==null?void 0:d.data,visible:H,onClose:function(){return I(!1)}}),(0,_.jsx)(Z.Z,{visible:re,onCancel:function(){return R(!1)},record:V,handleStatusChange:se})]})};v.default=k}}]);
